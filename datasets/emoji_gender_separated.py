import pandas as pd

# Load your dataset
# df = pd.read_csv("text2emoji.csv")

# Login using e.g. `huggingface-cli login` to access this dataset
df = pd.read_parquet("hf://datasets/DESUCLUB/combined_emoji_data/data/train-00000-of-00001.parquet")

# Complete sets of gendered emojis based on Unicode v15
male_emojis = {
    "ğŸ‘¨", "ğŸ‘¨â€âš•ï¸", "ğŸ‘¨â€ğŸ“", "ğŸ‘¨â€ğŸ«", "ğŸ‘¨â€âš–ï¸", "ğŸ‘¨â€ğŸŒ¾", "ğŸ‘¨â€ğŸ³", "ğŸ‘¨â€ğŸ”§", "ğŸ‘¨â€ğŸ­", "ğŸ‘¨â€ğŸ’¼", "ğŸ‘¨â€ğŸ”¬", "ğŸ‘¨â€ğŸ’»", "ğŸ‘¨â€ğŸ¤",
    "ğŸ‘¨â€ğŸ¨", "ğŸ‘¨â€âœˆï¸", "ğŸ‘¨â€ğŸš€", "ğŸ‘¨â€ğŸš’", "ğŸ‘®â€â™‚ï¸", "ğŸ•µï¸â€â™‚ï¸", "ğŸ’‚â€â™‚ï¸", "ğŸ‘·â€â™‚ï¸", "ğŸ¤´", "ğŸ‘³â€â™‚ï¸", "ğŸ‘²", "ğŸ§”â€â™‚ï¸", "ğŸ‘±â€â™‚ï¸",
    "ğŸ‘¨â€ğŸ¦°", "ğŸ‘¨â€ğŸ¦±", "ğŸ‘¨â€ğŸ¦³", "ğŸ‘¨â€ğŸ¦²", "ğŸ™â€â™‚ï¸", "ğŸ™â€â™‚ï¸", "ğŸ™…â€â™‚ï¸", "ğŸ™†â€â™‚ï¸", "ğŸ’â€â™‚ï¸", "ğŸ™‹â€â™‚ï¸", "ğŸ™‡â€â™‚ï¸", "ğŸ¤¦â€â™‚ï¸",
    "ğŸ¤·â€â™‚ï¸", "ğŸ’†â€â™‚ï¸", "ğŸ’‡â€â™‚ï¸", "ğŸš¶â€â™‚ï¸", "ğŸƒâ€â™‚ï¸", "ğŸ•º", "ğŸ§–â€â™‚ï¸", "ğŸ§˜â€â™‚ï¸", "ğŸ›€", "ğŸ›Œ", "ğŸ¤¹â€â™‚ï¸", "ğŸ¤¸â€â™‚ï¸", "ğŸš´â€â™‚ï¸",
    "ğŸšµâ€â™‚ï¸", "ğŸ‹ï¸â€â™‚ï¸", "ğŸ¤¼â€â™‚ï¸", "ğŸ¤½â€â™‚ï¸", "ğŸ¤¾â€â™‚ï¸", "ğŸ¤º", "ğŸŒï¸â€â™‚ï¸", "ğŸ„â€â™‚ï¸", "ğŸŠâ€â™‚ï¸", "ğŸ‡", "ğŸš£â€â™‚ï¸",
    "ğŸ§—â€â™‚ï¸", "ğŸ‘¬", "ğŸ’", "ğŸ‘¨â€â¤ï¸â€ğŸ‘¨", "ğŸ‘¨â€â¤ï¸â€ğŸ’‹â€ğŸ‘¨"
}

female_emojis = {
    "ğŸ‘©", "ğŸ‘©â€âš•ï¸", "ğŸ‘©â€ğŸ“", "ğŸ‘©â€ğŸ«", "ğŸ‘©â€âš–ï¸", "ğŸ‘©â€ğŸŒ¾", "ğŸ‘©â€ğŸ³", "ğŸ‘©â€ğŸ”§", "ğŸ‘©â€ğŸ­", "ğŸ‘©â€ğŸ’¼", "ğŸ‘©â€ğŸ”¬", "ğŸ‘©â€ğŸ’»", "ğŸ‘©â€ğŸ¤",
    "ğŸ‘©â€ğŸ¨", "ğŸ‘©â€âœˆï¸", "ğŸ‘©â€ğŸš€", "ğŸ‘©â€ğŸš’", "ğŸ‘®â€â™€ï¸", "ğŸ•µï¸â€â™€ï¸", "ğŸ’‚â€â™€ï¸", "ğŸ‘·â€â™€ï¸", "ğŸ‘¸", "ğŸ‘³â€â™€ï¸", "ğŸ§•", "ğŸ‘±â€â™€ï¸", "ğŸ‘©â€ğŸ¦°",
    "ğŸ‘©â€ğŸ¦±", "ğŸ‘©â€ğŸ¦³", "ğŸ‘©â€ğŸ¦²", "ğŸ™â€â™€ï¸", "ğŸ™â€â™€ï¸", "ğŸ™…â€â™€ï¸", "ğŸ™†â€â™€ï¸", "ğŸ’â€â™€ï¸", "ğŸ™‹â€â™€ï¸", "ğŸ™‡â€â™€ï¸", "ğŸ¤¦â€â™€ï¸", "ğŸ¤·â€â™€ï¸",
    "ğŸ’†â€â™€ï¸", "ğŸ’‡â€â™€ï¸", "ğŸš¶â€â™€ï¸", "ğŸƒâ€â™€ï¸", "ğŸ’ƒ", "ğŸ§–â€â™€ï¸", "ğŸ§˜â€â™€ï¸", "ğŸ›€", "ğŸ›Œ", "ğŸ¤¹â€â™€ï¸", "ğŸ¤¸â€â™€ï¸", "ğŸš´â€â™€ï¸", "ğŸšµâ€â™€ï¸",
    "ğŸ‹ï¸â€â™€ï¸", "ğŸ¤¼â€â™€ï¸", "ğŸ¤½â€â™€ï¸", "ğŸ¤¾â€â™€ï¸", "ğŸ¤º", "ğŸŒï¸â€â™€ï¸", "ğŸ„â€â™€ï¸", "ğŸŠâ€â™€ï¸", "ğŸ‡", "ğŸš£â€â™€ï¸", "ğŸ§—â€â™€ï¸",
    "ğŸ‘­", "ğŸ’", "ğŸ‘©â€â¤ï¸â€ğŸ‘©", "ğŸ‘©â€â¤ï¸â€ğŸ’‹â€ğŸ‘©", "ğŸ¤°", "ğŸ¤±", "ğŸ¤¶", "ğŸ§™â€â™€ï¸", "ğŸ§šâ€â™€ï¸", "ğŸ§›â€â™€ï¸", "ğŸ§œâ€â™€ï¸", "ğŸ§â€â™€ï¸", "ğŸ§â€â™€ï¸", "ğŸ§Ÿâ€â™€ï¸"
}

# Classification function explicitly distinguishing male or female
def classify_gender(emoji_sequence):
    for emoji in male_emojis:
        if emoji in emoji_sequence:
            return 'male'
    for emoji in female_emojis:
        if emoji in emoji_sequence:
            return 'female'
    return 'other'  # Exclude neutral explicitly

# Apply gender classification
df['gender'] = df['emoji'].apply(classify_gender)

# Filter clearly only male and female datasets
df_male = df[df['gender'] == 'male']
df_female = df[df['gender'] == 'female']

"""

# Save datasets explicitly with only "text" and "emoji" columns
df_male[['text', 'emoji']].to_csv("./datasets/emoji_male.csv", index=False)
df_female[['text', 'emoji']].to_csv("./datasets/emoji_female.csv", index=False)

"""

df_male[['text', 'emoji']].to_csv("./datasets/emoji_male.csv", index=False)
df_female[['text', 'emoji']].to_csv("./datasets/emoji_female.csv", index=False)
