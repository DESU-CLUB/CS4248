import pandas as pd

# Use this script to split a dataset into gendered and non-gendered datasets
# Reference: <emoji>-ELCo: Towards Gender Equality in Emoji Composition
# reference paper about ELCo from John dealing w gender emoji. their dataset is called ELCo-AN but cannot find the dataset

# Load your dataset
# df = pd.read_csv("./datasets/ELCo_adapted_edited.csv")  # Edit this to split the combined dataset

# Login using e.g. `huggingface-cli login` to access this dataset
df = pd.read_parquet("hf://datasets/DESUCLUB/combined_emoji_data/data/train-00000-of-00001.parquet")

# Complete sets of gendered emojis based on Unicode v15
gendered_emojis = {
    "ğŸ‘¨", "ğŸ‘¨â€âš•ï¸", "ğŸ‘¨â€ğŸ“", "ğŸ‘¨â€ğŸ«", "ğŸ‘¨â€âš–ï¸", "ğŸ‘¨â€ğŸŒ¾", "ğŸ‘¨â€ğŸ³", "ğŸ‘¨â€ğŸ”§", "ğŸ‘¨â€ğŸ­", "ğŸ‘¨â€ğŸ’¼", "ğŸ‘¨â€ğŸ”¬", "ğŸ‘¨â€ğŸ’»", "ğŸ‘¨â€ğŸ¤",
    "ğŸ‘¨â€ğŸ¨", "ğŸ‘¨â€âœˆï¸", "ğŸ‘¨â€ğŸš€", "ğŸ‘¨â€ğŸš’", "ğŸ‘®â€â™‚ï¸", "ğŸ•µï¸â€â™‚ï¸", "ğŸ’‚â€â™‚ï¸", "ğŸ‘·â€â™‚ï¸", "ğŸ¤´", "ğŸ‘³â€â™‚ï¸", "ğŸ‘²", "ğŸ§”â€â™‚ï¸", "ğŸ‘±â€â™‚ï¸",
    "ğŸ‘¨â€ğŸ¦°", "ğŸ‘¨â€ğŸ¦±", "ğŸ‘¨â€ğŸ¦³", "ğŸ‘¨â€ğŸ¦²", "ğŸ™â€â™‚ï¸", "ğŸ™â€â™‚ï¸", "ğŸ™…â€â™‚ï¸", "ğŸ™†â€â™‚ï¸", "ğŸ’â€â™‚ï¸", "ğŸ™‹â€â™‚ï¸", "ğŸ™‡â€â™‚ï¸", "ğŸ¤¦â€â™‚ï¸",
    "ğŸ¤·â€â™‚ï¸", "ğŸ’†â€â™‚ï¸", "ğŸ’‡â€â™‚ï¸", "ğŸš¶â€â™‚ï¸", "ğŸƒâ€â™‚ï¸", "ğŸ•º", "ğŸ§–â€â™‚ï¸", "ğŸ§˜â€â™‚ï¸", "ğŸ›€", "ğŸ›Œ", "ğŸ¤¹â€â™‚ï¸", "ğŸ¤¸â€â™‚ï¸", "ğŸš´â€â™‚ï¸",
    "ğŸšµâ€â™‚ï¸", "ğŸ‹ï¸â€â™‚ï¸", "ğŸ¤¼â€â™‚ï¸", "ğŸ¤½â€â™‚ï¸", "ğŸ¤¾â€â™‚ï¸", "ğŸ¤º", "ğŸŒï¸â€â™‚ï¸", "ğŸ„â€â™‚ï¸", "ğŸŠâ€â™‚ï¸", "ğŸ‡", "ğŸš£â€â™‚ï¸",
    "ğŸ§—â€â™‚ï¸", "ğŸ‘¬", "ğŸ’", "ğŸ‘¨â€â¤ï¸â€ğŸ‘¨", "ğŸ‘¨â€â¤ï¸â€ğŸ’‹â€ğŸ‘¨",

    "ğŸ‘©", "ğŸ‘©â€âš•ï¸", "ğŸ‘©â€ğŸ“", "ğŸ‘©â€ğŸ«", "ğŸ‘©â€âš–ï¸", "ğŸ‘©â€ğŸŒ¾", "ğŸ‘©â€ğŸ³", "ğŸ‘©â€ğŸ”§", "ğŸ‘©â€ğŸ­", "ğŸ‘©â€ğŸ’¼", "ğŸ‘©â€ğŸ”¬", "ğŸ‘©â€ğŸ’»", "ğŸ‘©â€ğŸ¤",
    "ğŸ‘©â€ğŸ¨", "ğŸ‘©â€âœˆï¸", "ğŸ‘©â€ğŸš€", "ğŸ‘©â€ğŸš’", "ğŸ‘®â€â™€ï¸", "ğŸ•µï¸â€â™€ï¸", "ğŸ’‚â€â™€ï¸", "ğŸ‘·â€â™€ï¸", "ğŸ‘¸", "ğŸ‘³â€â™€ï¸", "ğŸ§•", "ğŸ‘±â€â™€ï¸", "ğŸ‘©â€ğŸ¦°",
    "ğŸ‘©â€ğŸ¦±", "ğŸ‘©â€ğŸ¦³", "ğŸ‘©â€ğŸ¦²", "ğŸ™â€â™€ï¸", "ğŸ™â€â™€ï¸", "ğŸ™…â€â™€ï¸", "ğŸ™†â€â™€ï¸", "ğŸ’â€â™€ï¸", "ğŸ™‹â€â™€ï¸", "ğŸ™‡â€â™€ï¸", "ğŸ¤¦â€â™€ï¸", "ğŸ¤·â€â™€ï¸",
    "ğŸ’†â€â™€ï¸", "ğŸ’‡â€â™€ï¸", "ğŸš¶â€â™€ï¸", "ğŸƒâ€â™€ï¸", "ğŸ’ƒ", "ğŸ§–â€â™€ï¸", "ğŸ§˜â€â™€ï¸", "ğŸ›€", "ğŸ›Œ", "ğŸ¤¹â€â™€ï¸", "ğŸ¤¸â€â™€ï¸", "ğŸš´â€â™€ï¸", "ğŸšµâ€â™€ï¸",
    "ğŸ‹ï¸â€â™€ï¸", "ğŸ¤¼â€â™€ï¸", "ğŸ¤½â€â™€ï¸", "ğŸ¤¾â€â™€ï¸", "ğŸ¤º", "ğŸŒï¸â€â™€ï¸", "ğŸ„â€â™€ï¸", "ğŸŠâ€â™€ï¸", "ğŸ‡", "ğŸš£â€â™€ï¸", "ğŸ§—â€â™€ï¸",
    "ğŸ‘­", "ğŸ’", "ğŸ‘©â€â¤ï¸â€ğŸ‘©", "ğŸ‘©â€â¤ï¸â€ğŸ’‹â€ğŸ‘©", "ğŸ¤°", "ğŸ¤±", "ğŸ¤¶", "ğŸ§™â€â™€ï¸", "ğŸ§šâ€â™€ï¸", "ğŸ§›â€â™€ï¸", "ğŸ§œâ€â™€ï¸", "ğŸ§â€â™€ï¸", "ğŸ§â€â™€ï¸", "ğŸ§Ÿâ€â™€ï¸"
}

# gendered_emojis = {
#     # Basic gender representations
#     "ğŸ‘¨", "ğŸ‘©", "ğŸ§‘",
#     "ğŸ‘§", "ğŸ‘¦", "ğŸ§’",
#     "ğŸ‘´", "ğŸ‘µ", "ğŸ§“",

#     # Professions (ZWJ sequences, gendered)
#     "ğŸ‘¨â€âš•ï¸", "ğŸ‘©â€âš•ï¸", "ğŸ§‘â€âš•ï¸",
#     "ğŸ‘¨â€ğŸ«", "ğŸ‘©â€ğŸ«", "ğŸ§‘â€ğŸ«",
#     "ğŸ‘¨â€ğŸ³", "ğŸ‘©â€ğŸ³", "ğŸ§‘â€ğŸ³",
#     "ğŸ‘¨â€ğŸ“", "ğŸ‘©â€ğŸ“", "ğŸ§‘â€ğŸ“",
#     "ğŸ‘¨â€ğŸ­", "ğŸ‘©â€ğŸ­", "ğŸ§‘â€ğŸ­",
#     "ğŸ‘¨â€ğŸ’»", "ğŸ‘©â€ğŸ’»", "ğŸ§‘â€ğŸ’»",
#     "ğŸ‘¨â€ğŸ’¼", "ğŸ‘©â€ğŸ’¼", "ğŸ§‘â€ğŸ’¼",
#     "ğŸ‘¨â€ğŸ”§", "ğŸ‘©â€ğŸ”§", "ğŸ§‘â€ğŸ”§",
#     "ğŸ‘¨â€ğŸ¤", "ğŸ‘©â€ğŸ¤", "ğŸ§‘â€ğŸ¤",
#     "ğŸ‘¨â€ğŸ¨", "ğŸ‘©â€ğŸ¨", "ğŸ§‘â€ğŸ¨",
#     "ğŸ‘¨â€ğŸš€", "ğŸ‘©â€ğŸš€", "ğŸ§‘â€ğŸš€",
#     "ğŸ‘¨â€âš–ï¸", "ğŸ‘©â€âš–ï¸", "ğŸ§‘â€âš–ï¸",
#     "ğŸ‘¨â€ğŸš’", "ğŸ‘©â€ğŸš’", "ğŸ§‘â€ğŸš’",
#     "ğŸ‘¨â€ğŸŒ¾", "ğŸ‘©â€ğŸŒ¾", "ğŸ§‘â€ğŸŒ¾",
#     "ğŸ‘¨â€âœˆï¸", "ğŸ‘©â€âœˆï¸", "ğŸ§‘â€âœˆï¸",

#     # Miscellaneous gender-related
#     "ğŸ‘±â€â™€ï¸", "ğŸ‘±â€â™‚ï¸",
#     "ğŸ™â€â™‚ï¸", "ğŸ™â€â™€ï¸",
#     "ğŸ™â€â™‚ï¸", "ğŸ™â€â™€ï¸",
#     "ğŸ™…â€â™‚ï¸", "ğŸ™…â€â™€ï¸",
#     "ğŸ™†â€â™‚ï¸", "ğŸ™†â€â™€ï¸",
#     "ğŸ’â€â™‚ï¸", "ğŸ’â€â™€ï¸",
#     "ğŸ™‹â€â™‚ï¸", "ğŸ™‹â€â™€ï¸",
#     "ğŸ™‡â€â™‚ï¸", "ğŸ™‡â€â™€ï¸",
#     "ğŸ¤¦â€â™‚ï¸", "ğŸ¤¦â€â™€ï¸",
#     "ğŸ¤·â€â™‚ï¸", "ğŸ¤·â€â™€ï¸"
# }


# Function to detect if a row contains any gendered emoji
def contains_gendered_emoji(emoji_sequence):
    return any(gendered in emoji_sequence for gendered in gendered_emojis)

# Filter
df_gendered = df[df['emoji'].apply(contains_gendered_emoji)]
df_non_gendered = df[~df['emoji'].apply(contains_gendered_emoji)]

# Save results
df_gendered.to_csv("./datasets/emoji_gendered.csv", index=False)
df_non_gendered.to_csv("./datasets/emoji_nongendered.csv", index=False)
